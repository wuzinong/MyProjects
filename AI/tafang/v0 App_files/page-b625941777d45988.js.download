(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{2747:(e,t,a)=>{Promise.resolve().then(a.bind(a,4042))},4042:(e,t,a)=>{"use strict";a.d(t,{default:()=>Q});var l=a(5155),s=a(2115),i=a(9708),o=a(2085),r=a(2596),n=a(9688);function c(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,n.QP)((0,r.$)(t))}let d=(0,o.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),p=s.forwardRef((e,t)=>{let{className:a,variant:s,size:o,asChild:r=!1,...n}=e,p=r?i.DX:"button";return(0,l.jsx)(p,{className:c(d({variant:s,size:o,className:a})),ref:t,...n})});p.displayName="Button";let h=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,l.jsx)("div",{ref:t,className:c("rounded-lg border bg-card text-card-foreground shadow-sm",a),...s})});h.displayName="Card";let m=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,l.jsx)("div",{ref:t,className:c("flex flex-col space-y-1.5 p-6",a),...s})});m.displayName="CardHeader";let g=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,l.jsx)("div",{ref:t,className:c("text-2xl font-semibold leading-none tracking-tight",a),...s})});g.displayName="CardTitle",s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,l.jsx)("div",{ref:t,className:c("text-sm text-muted-foreground",a),...s})}).displayName="CardDescription";let f=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,l.jsx)("div",{ref:t,className:c("p-6 pt-0",a),...s})});f.displayName="CardContent",s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,l.jsx)("div",{ref:t,className:c("flex items-center p-6 pt-0",a),...s})}).displayName="CardFooter";var x=a(5863);let u=s.forwardRef((e,t)=>{let{className:a,value:s,...i}=e;return(0,l.jsx)(x.bL,{ref:t,className:c("relative h-4 w-full overflow-hidden rounded-full bg-secondary",a),...i,children:(0,l.jsx)(x.C1,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:"translateX(-".concat(100-(s||0),"%)")}})})});u.displayName=x.bL.displayName;let b=(0,o.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function y(e){let{className:t,variant:a,...s}=e;return(0,l.jsx)("div",{className:c(b({variant:a}),t),...s})}var w=a(3470),v=a(4416);let j=w.bL;w.l9;let k=w.ZL;w.bm;let N=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,l.jsx)(w.hJ,{ref:t,className:c("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...s})});N.displayName=w.hJ.displayName;let D=s.forwardRef((e,t)=>{let{className:a,children:s,...i}=e;return(0,l.jsxs)(k,{children:[(0,l.jsx)(N,{}),(0,l.jsxs)(w.UC,{ref:t,className:c("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...i,children:[s,(0,l.jsxs)(w.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,l.jsx)(v.A,{className:"h-4 w-4"}),(0,l.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});D.displayName=w.UC.displayName;let S=e=>{let{className:t,...a}=e;return(0,l.jsx)("div",{className:c("flex flex-col space-y-1.5 text-center sm:text-left",t),...a})};S.displayName="DialogHeader";let M=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,l.jsx)(w.hE,{ref:t,className:c("text-lg font-semibold leading-none tracking-tight",a),...s})});M.displayName=w.hE.displayName,s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,l.jsx)(w.VY,{ref:t,className:c("text-sm text-muted-foreground",a),...s})}).displayName=w.VY.displayName;var T=a(6049);let C=T.bL,I=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,l.jsx)(T.B8,{ref:t,className:c("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",a),...s})});I.displayName=T.B8.displayName;let E=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,l.jsx)(T.l9,{ref:t,className:c("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",a),...s})});E.displayName=T.l9.displayName;let _=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,l.jsx)(T.UC,{ref:t,className:c("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",a),...s})});_.displayName=T.UC.displayName;let R=s.forwardRef((e,t)=>{let{className:a,type:s,...i}=e;return(0,l.jsx)("input",{type:s,className:c("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:t,...i})});R.displayName="Input";var P=a(5690),A=a(2178),W=a(238),O=a(133),L=a(1976),H=a(3550),G=a(5525),B=a(8186),z=a(7580),U=a(8564),F=a(9881);let K=[{x:0,y:5},{x:1,y:5},{x:2,y:5},{x:3,y:5},{x:4,y:5},{x:5,y:5},{x:5,y:6},{x:5,y:7},{x:5,y:8},{x:5,y:9},{x:5,y:10},{x:5,y:11},{x:5,y:12},{x:6,y:12},{x:7,y:12},{x:8,y:12},{x:9,y:12},{x:10,y:12},{x:11,y:12},{x:12,y:12},{x:13,y:12},{x:14,y:12},{x:15,y:12},{x:16,y:12},{x:17,y:12},{x:18,y:12},{x:18,y:11},{x:18,y:10},{x:18,y:9},{x:18,y:8},{x:18,y:7},{x:18,y:6},{x:18,y:5},{x:18,y:4},{x:18,y:3},{x:19,y:3},{x:20,y:3},{x:21,y:3},{x:22,y:3},{x:23,y:3},{x:24,y:3}],q={DOUBLE_SHOT:{name:"双重射击",description:"同时攻击两个目标",icon:"\uD83C\uDFAF"},CRITICAL_HIT:{name:"暴击",description:"20%几率造成双倍伤害",icon:"\uD83D\uDCA5"},ARMOR_PIERCE:{name:"破甲",description:"无视敌人护甲",icon:"\uD83D\uDDE1️"},LIFE_STEAL:{name:"生命汲取",description:"攻击回复基地生命",icon:"\uD83D\uDC9A"},CHAIN_LIGHTNING:{name:"连锁闪电",description:"攻击可跳跃到附近敌人",icon:"⚡"},FREEZE_CHANCE:{name:"冰冻几率",description:"30%几率冰冻敌人",icon:"❄️"},POISON_CLOUD:{name:"毒云",description:"攻击产生毒云",icon:"☠️"},SHIELD_GENERATOR:{name:"护盾生成",description:"为附近建筑提供护盾",icon:"\uD83D\uDEE1️"},GOLD_BONUS:{name:"黄金加成",description:"击杀敌人获得额外金币",icon:"\uD83D\uDCB0"},EXPERIENCE_BOOST:{name:"经验加成",description:"附近英雄获得双倍经验",icon:"\uD83D\uDCDA"}},V={ARCHER:{id:"archer",name:"精灵箭塔",cost:60,damage:35,range:3.5,attackSpeed:800,color:"#22c55e",icon:"\uD83C\uDFF9",projectileType:"arrow",description:"精准的远程攻击，射程较远"},CANNON:{id:"cannon",name:"矮人火炮",cost:120,damage:80,range:3,attackSpeed:1800,color:"#dc2626",icon:"\uD83D\uDCA3",projectileType:"cannonball",splashRadius:1.5,description:"强力的溅射伤害"},MAGIC:{id:"magic",name:"法师塔",cost:100,damage:50,range:2.8,attackSpeed:1200,color:"#8b5cf6",icon:"\uD83D\uDD2E",projectileType:"magic",description:"魔法攻击，无视护甲"},ICE:{id:"ice",name:"冰霜要塞",cost:90,damage:25,range:2.5,attackSpeed:1e3,slowEffect:.4,slowDuration:3e3,color:"#06b6d4",icon:"❄️",projectileType:"ice",description:"减缓敌人移动速度"},LIGHTNING:{id:"lightning",name:"雷电神殿",cost:150,damage:60,range:3.2,attackSpeed:1400,color:"#eab308",icon:"⚡",projectileType:"lightning",chainCount:3,description:"闪电链攻击"},POISON:{id:"poison",name:"毒液巢穴",cost:80,damage:20,range:2.2,attackSpeed:600,color:"#84cc16",icon:"☠️",projectileType:"poison",poisonDamage:10,poisonDuration:5e3,description:"持续毒伤"},LASER:{id:"laser",name:"激光炮台",cost:200,damage:100,range:4,attackSpeed:2500,color:"#ef4444",icon:"\uD83D\uDD34",projectileType:"laser",piercing:!0,description:"激光穿透攻击，可穿透多个敌人"},MISSILE:{id:"missile",name:"导弹发射器",cost:180,damage:120,range:5,attackSpeed:3e3,color:"#f97316",icon:"\uD83D\uDE80",projectileType:"missile",splashRadius:2,description:"远程导弹，大范围爆炸"},BARRIER:{id:"barrier",name:"能量屏障",cost:150,damage:0,range:0,attackSpeed:0,color:"#3b82f6",icon:"\uD83D\uDEE1️",projectileType:"none",blocking:!0,health:500,description:"阻挡敌人前进，可被摧毁"},SUPPORT:{id:"support",name:"增益神坛",cost:120,damage:0,range:3,attackSpeed:0,color:"#a855f7",icon:"✨",projectileType:"none",buffRange:3,buffEffect:1.5,description:"增强范围内建筑50%攻击力"},MINE:{id:"mine",name:"地雷阵",cost:40,damage:150,range:.5,attackSpeed:0,color:"#78716c",icon:"\uD83D\uDCA5",projectileType:"explosion",oneTime:!0,description:"一次性爆炸，对接近敌人造成巨大伤害"},SUMMONER:{id:"summoner",name:"召唤祭坛",cost:250,damage:0,range:2,attackSpeed:5e3,color:"#7c3aed",icon:"\uD83D\uDC7B",projectileType:"summon",description:"定期召唤友军单位协助战斗"},TESLA:{id:"tesla",name:"特斯拉线圈",cost:300,damage:150,range:2.5,attackSpeed:2e3,color:"#06b6d4",icon:"⚡",projectileType:"tesla",chainCount:5,description:"强力电击，可连锁攻击多个敌人"},PLASMA:{id:"plasma",name:"等离子炮",cost:400,damage:200,range:4.5,attackSpeed:3500,color:"#ec4899",icon:"\uD83C\uDF1F",projectileType:"plasma",piercing:!0,description:"等离子束穿透所有敌人"},GRAVITY:{id:"gravity",name:"重力井",cost:350,damage:0,range:3,attackSpeed:1e3,color:"#7c2d12",icon:"\uD83C\uDF00",projectileType:"gravity",pullEffect:!0,description:"减缓并拉拽范围内的敌人"},TEMPORAL:{id:"temporal",name:"时间扭曲器",cost:500,damage:0,range:2.5,attackSpeed:4e3,color:"#581c87",icon:"⏰",projectileType:"temporal",timeEffect:!0,description:"减缓时间流速，敌人移动极慢"},NUCLEAR:{id:"nuclear",name:"核弹发射器",cost:800,damage:500,range:6,attackSpeed:8e3,color:"#dc2626",icon:"☢️",projectileType:"nuclear",splashRadius:4,description:"终极武器，巨大范围核爆"},HEALING:{id:"healing",name:"治疗神殿",cost:200,damage:0,range:3,attackSpeed:2e3,color:"#22c55e",icon:"\uD83D\uDC9A",projectileType:"heal",healAmount:100,description:"治疗范围内的友军和建筑"},TELEPORTER:{id:"teleporter",name:"传送门",cost:600,damage:0,range:1,attackSpeed:0,color:"#8b5cf6",icon:"\uD83C\uDF00",projectileType:"teleport",teleportEffect:!0,description:"将敌人传送回起点"},MIND_CONTROL:{id:"mind_control",name:"心灵控制塔",cost:450,damage:0,range:2,attackSpeed:5e3,color:"#ec4899",icon:"\uD83E\uDDE0",projectileType:"mind_control",controlEffect:!0,description:"控制敌人为我方作战"}},X={ORC:{id:"orc",name:"兽人步兵",health:120,speed:1.2,reward:15,color:"#ef4444",emoji:"\uD83E\uDDCC",armor:0,image:"https://static.wikia.nocookie.net/wowpedia/images/thumb/8/8a/Grunt_WC3.jpg/256px-Grunt_WC3.jpg"},TROLL:{id:"troll",name:"巨魔猎手",health:80,speed:2,reward:20,color:"#f97316",emoji:"\uD83C\uDFC3",armor:0,image:"https://static.wikia.nocookie.net/wowpedia/images/thumb/b/b5/Troll_Headhunter_WC3.jpg/256px-Troll_Headhunter_WC3.jpg"},OGRE:{id:"ogre",name:"食人魔",health:250,speed:.8,reward:35,color:"#6b7280",emoji:"\uD83D\uDC79",armor:2,image:"https://static.wikia.nocookie.net/wowpedia/images/thumb/f/f5/Ogre_Warrior_WC3.jpg/256px-Ogre_Warrior_WC3.jpg"},DRAGON:{id:"dragon",name:"幼龙",health:180,speed:1.5,reward:50,color:"#7c3aed",emoji:"\uD83D\uDC32",armor:1,flying:!0,image:"https://static.wikia.nocookie.net/wowpedia/images/thumb/2/2c/Red_Dragon_Whelp_WC3.jpg/256px-Red_Dragon_Whelp_WC3.jpg"},DEMON:{id:"demon",name:"恶魔领主",health:600,speed:1,reward:150,color:"#991b1b",emoji:"\uD83D\uDC7F",armor:3,boss:!0,image:"https://static.wikia.nocookie.net/wowpedia/images/thumb/a/a8/Pit_Lord_WC3.jpg/256px-Pit_Lord_WC3.jpg"},ELITE_ORC:{id:"elite_orc",name:"精英兽人",health:300,speed:1,reward:60,color:"#dc2626",emoji:"\uD83D\uDC51",armor:2,elite:!0,image:"https://static.wikia.nocookie.net/wowpedia/images/thumb/1/1c/Orc_Raider_WC3.jpg/256px-Orc_Raider_WC3.jpg"},ELITE_TROLL:{id:"elite_troll",name:"精英巨魔",health:200,speed:1.8,reward:80,color:"#ea580c",emoji:"⚡",armor:1,elite:!0,image:"https://static.wikia.nocookie.net/wowpedia/images/thumb/8/8c/Troll_Berserker_WC3.jpg/256px-Troll_Berserker_WC3.jpg"},SKELETON:{id:"skeleton",name:"骷髅战士",health:60,speed:1.5,reward:12,color:"#f3f4f6",emoji:"\uD83D\uDC80",armor:0,image:"https://static.wikia.nocookie.net/wowpedia/images/thumb/d/d4/Skeleton_Warrior_WC3.jpg/256px-Skeleton_Warrior_WC3.jpg"},GOLEM:{id:"golem",name:"石头人",health:800,speed:.5,reward:100,color:"#78716c",emoji:"\uD83D\uDDFF",armor:5,image:"https://static.wikia.nocookie.net/wowpedia/images/thumb/7/7a/Stone_Golem_WC3.jpg/256px-Stone_Golem_WC3.jpg"},WRAITH:{id:"wraith",name:"幽灵",health:100,speed:2.5,reward:40,color:"#a855f7",emoji:"\uD83D\uDC7B",armor:0,flying:!0,magical:!0,image:"https://static.wikia.nocookie.net/wowpedia/images/thumb/5/5e/Wraith_WC3.jpg/256px-Wraith_WC3.jpg"},BOSS_GIANT:{id:"boss_giant",name:"巨人王",health:2e3,speed:.6,reward:500,color:"#7f1d1d",emoji:"\uD83D\uDC79",armor:8,boss:!0,image:"https://static.wikia.nocookie.net/wowpedia/images/thumb/3/3c/Mountain_Giant_WC3.jpg/256px-Mountain_Giant_WC3.jpg"},BOSS_LICH:{id:"boss_lich",name:"巫妖王",health:1500,speed:1.2,reward:600,color:"#581c87",emoji:"\uD83D\uDC80",armor:5,boss:!0,magical:!0,image:"https://static.wikia.nocookie.net/wowpedia/images/thumb/f/f4/Lich_WC3.jpg/256px-Lich_WC3.jpg"},BOSS_DRAGON:{id:"boss_dragon",name:"古龙",health:3e3,speed:1,reward:800,color:"#dc2626",emoji:"\uD83D\uDC09",armor:10,boss:!0,flying:!0,image:"https://static.wikia.nocookie.net/wowpedia/images/thumb/8/8f/Red_Dragon_WC3.jpg/256px-Red_Dragon_WC3.jpg"}},Y={FIREBALL:{id:"fireball",name:"火球术",cost:50,damage:300,range:2,cooldown:1e4,icon:"\uD83D\uDD25",description:"对目标区域造成火焰伤害",type:"damage"},FREEZE:{id:"freeze",name:"冰冻术",cost:40,duration:5e3,range:2.5,cooldown:15e3,icon:"❄️",description:"冰冻区域内所有敌人",type:"control"},LIGHTNING_STORM:{id:"lightning_storm",name:"闪电风暴",cost:80,damage:200,range:3,cooldown:2e4,icon:"⚡",description:"对大范围敌人造成闪电伤害",type:"damage"},HEAL:{id:"heal",name:"治疗术",cost:30,healing:300,range:2,cooldown:8e3,icon:"\uD83D\uDC9A",description:"治疗范围内的友军单位",type:"support"},METEOR:{id:"meteor",name:"陨石术",cost:100,damage:800,range:1.5,cooldown:3e4,icon:"☄️",description:"召唤陨石造成巨大伤害",type:"damage"},TIME_STOP:{id:"time_stop",name:"时间停止",cost:120,duration:3e3,range:5,cooldown:45e3,icon:"⏸️",description:"停止所有敌人3秒",type:"control"}},Z={PALADIN:{id:"paladin",name:"圣骑士",health:500,damage:80,range:1.5,attackSpeed:1e3,color:"#fbbf24",icon:"⚔️",image:"https://static.wikia.nocookie.net/wowpedia/images/thumb/a/a8/Paladin_WC3.jpg/256px-Paladin_WC3.jpg",description:"神圣战士，拥有强大的近战能力和治疗技能",skills:["圣光术","冲锋","神圣护盾"],rarity:"common"},ARCHMAGE:{id:"archmage",name:"大法师",health:300,damage:120,range:3.5,attackSpeed:1500,color:"#8b5cf6",icon:"\uD83E\uDDD9",image:"https://static.wikia.nocookie.net/wowpedia/images/thumb/2/2f/Archmage_WC3.jpg/256px-Archmage_WC3.jpg",description:"强大的法师，掌握毁灭性的魔法",skills:["火球术","传送","魔法护盾"],rarity:"common"},MOUNTAIN_KING:{id:"mountain_king",name:"山丘之王",health:800,damage:100,range:1.2,attackSpeed:800,color:"#dc2626",icon:"\uD83D\uDD28",image:"https://static.wikia.nocookie.net/wowpedia/images/thumb/f/f8/Mountain_King_WC3.jpg/256px-Mountain_King_WC3.jpg",description:"矮人英雄，拥有强大的近战攻击和群体技能",skills:["雷霆一击","风暴之锤","头像"],rarity:"common"},DEMON_HUNTER:{id:"demon_hunter",name:"恶魔猎手",health:400,damage:90,range:2.5,attackSpeed:600,color:"#22c55e",icon:"\uD83C\uDFF9",image:"https://static.wikia.nocookie.net/wowpedia/images/thumb/d/d5/Demon_Hunter_WC3.jpg/256px-Demon_Hunter_WC3.jpg",description:"敏捷的远程英雄，擅长快速攻击",skills:["法力燃烧","献祭","变身"],rarity:"common"},DEATH_KNIGHT:{id:"death_knight",name:"死亡骑士",health:600,damage:110,range:1.5,attackSpeed:1200,color:"#7c3aed",icon:"\uD83D\uDC80",image:"https://static.wikia.nocookie.net/wowpedia/images/thumb/8/8a/Death_Knight_WC3.jpg/256px-Death_Knight_WC3.jpg",description:"黑暗英雄，拥有死灵法术和强大攻击",skills:["死亡缠绕","腐朽","死亡契约"],rarity:"common"},BLADEMASTER:{id:"blademaster",name:"剑圣",health:450,damage:95,range:1.8,attackSpeed:700,color:"#f97316",icon:"\uD83D\uDDE1️",image:"https://static.wikia.nocookie.net/wowpedia/images/thumb/b/b4/Blademaster_WC3.jpg/256px-Blademaster_WC3.jpg",description:"兽族英雄，拥有致命的剑术",skills:["疾风步","镜像","剑刃风暴"],rarity:"common"},GOKU:{id:"goku",name:"孙悟空",health:1500,damage:300,range:2,attackSpeed:500,color:"#ff6b35",icon:"\uD83E\uDD4B",image:"https://i.imgur.com/goku-ssj.png",description:"地球最强战士，拥有超级赛亚人变身能力",skills:["龟派气功","瞬间移动","超级赛亚人变身"],rarity:"epic",series:"dragon_ball"},VEGETA:{id:"vegeta",name:"贝吉塔",health:1400,damage:320,range:2.2,attackSpeed:600,color:"#4a90e2",icon:"\uD83D\uDC51",image:"https://i.imgur.com/vegeta-ssj.png",description:"赛亚人王子，拥有强大的战斗本能和自尊心",skills:["终极闪光","大爆炸攻击","超级赛亚人蓝"],rarity:"epic",series:"dragon_ball"},GOHAN:{id:"gohan",name:"孙悟饭",health:1200,damage:280,range:2.5,attackSpeed:700,color:"#50c878",icon:"\uD83D\uDCDA",image:"https://i.imgur.com/gohan-ultimate.png",description:"悟空之子，拥有巨大的潜在力量",skills:["魔闪光","潜能解放","究极形态"],rarity:"epic",series:"dragon_ball"},PICCOLO:{id:"piccolo",name:"比克",health:1100,damage:250,range:3,attackSpeed:800,color:"#228b22",icon:"\uD83E\uDDD8",image:"https://i.imgur.com/piccolo.png",description:"那美克星人，拥有再生能力和强大的气功",skills:["魔贯光杀炮","巨大化","再生"],rarity:"epic",series:"dragon_ball"},PIKACHU:{id:"pikachu",name:"皮卡丘",health:800,damage:200,range:2.8,attackSpeed:400,color:"#ffcc00",icon:"⚡",image:"https://assets.pokemon.com/assets/cms2/img/pokedex/full/025.png",description:"电气鼠宝可梦，拥有强大的电系攻击",skills:["十万伏特","电光一闪","打雷"],rarity:"epic",series:"pokemon"},CHARIZARD:{id:"charizard",name:"喷火龙",health:1300,damage:350,range:3.5,attackSpeed:1e3,color:"#ff4500",icon:"\uD83D\uDD25",image:"https://assets.pokemon.com/assets/cms2/img/pokedex/full/006.png",description:"火系飞行宝可梦，拥有强大的火焰攻击",skills:["喷射火焰","龙之怒","热风"],rarity:"epic",series:"pokemon"},MEWTWO:{id:"mewtwo",name:"超梦",health:1e3,damage:400,range:4,attackSpeed:1200,color:"#a855f7",icon:"\uD83E\uDDE0",image:"https://assets.pokemon.com/assets/cms2/img/pokedex/full/150.png",description:"传说中的超能力宝可梦，拥有无与伦比的精神力量",skills:["精神强念","影子球","自我再生"],rarity:"epic",series:"pokemon"},LUCARIO:{id:"lucario",name:"路卡利欧",health:900,damage:260,range:2,attackSpeed:600,color:"#4682b4",icon:"\uD83D\uDC4A",image:"https://assets.pokemon.com/assets/cms2/img/pokedex/full/448.png",description:"格斗系钢系宝可梦，能感知波导的力量",skills:["波导弹","近身战","金属爪"],rarity:"epic",series:"pokemon"}},J=(()=>{let e=[];for(let t=1;t<=100;t++){let a=Math.pow(1.15,t-1),l=Math.floor(8+2*t+Math.pow(t,1.2)),s=Math.min(.1+.01*t,.8),i=Math.floor(40+10*t+Math.pow(t,1.1)),o={enemies:[],delay:Math.max(300,1500-10*t),reward:i,eliteChance:s,baseMultiplier:a};t<=10?(o.enemies.push({type:"ORC",count:Math.floor(.8*l)}),o.enemies.push({type:"SKELETON",count:Math.floor(.2*l)})):t<=20?(o.enemies.push({type:"ORC",count:Math.floor(.4*l)}),o.enemies.push({type:"TROLL",count:Math.floor(.3*l)}),o.enemies.push({type:"SKELETON",count:Math.floor(.3*l)})):t<=40?(o.enemies.push({type:"TROLL",count:Math.floor(.3*l)}),o.enemies.push({type:"OGRE",count:Math.floor(.3*l)}),o.enemies.push({type:"DRAGON",count:Math.floor(.2*l)}),o.enemies.push({type:"WRAITH",count:Math.floor(.2*l)})):t<=70?(o.enemies.push({type:"OGRE",count:Math.floor(.3*l)}),o.enemies.push({type:"DRAGON",count:Math.floor(.3*l)}),o.enemies.push({type:"GOLEM",count:Math.floor(.2*l)}),o.enemies.push({type:"DEMON",count:Math.floor(.2*l)})):(o.enemies.push({type:"DRAGON",count:Math.floor(.3*l)}),o.enemies.push({type:"GOLEM",count:Math.floor(.3*l)}),o.enemies.push({type:"DEMON",count:Math.floor(.4*l)})),e.push(o)}return e})();function Q(){var e,t;let a=(0,s.useRef)(null),i=(0,s.useRef)(),o=(0,s.useRef)(0),r=(0,s.useRef)(null),[n,c]=(0,s.useState)(!1),[d,x]=(0,s.useState)({status:"idle",lives:50,gold:500,wave:0,score:0,towers:[],enemies:[],heroes:[],projectiles:[],effects:[],droppedItems:[],skills:[],selectedTowerType:null,selectedTower:null,selectedHero:null,selectedSkill:null,waveInProgress:!1,enemiesSpawned:0,totalEnemiesInWave:0,showUpgradeDialog:!1,showHeroDialog:!1,showCodeDialog:!1,autoWaveTimer:0,bossSpawned:!1,codeInput:""}),b=(0,s.useCallback)(()=>{let e=r.current;if(!e||n)return;let t=e.getContext("2d");if(!t)return;let a=t.createLinearGradient(0,0,0,800);a.addColorStop(0,"#0f172a"),a.addColorStop(.7,"#1e293b"),a.addColorStop(1,"#334155"),t.fillStyle=a,t.fillRect(0,0,800,800),t.fillStyle="#fbbf24";for(let e=0;e<50;e++){let a=137*e%800,l=211*e%480,s=2*Math.sin(e)+2;t.beginPath(),t.arc(a,l,s,0,2*Math.PI),t.fill()}t.fillStyle="#fef3c7",t.beginPath(),t.arc(720,60,25,0,2*Math.PI),t.fill(),t.fillStyle="#f59e0b",t.beginPath(),t.arc(725,65,20,0,2*Math.PI),t.fill();for(let e=0;e<25;e++)for(let a=0;a<25;a++)!K.some(t=>t.x===e&&t.y===a)&&(t.fillStyle=Math.random()>.5?"#166534":"#15803d",t.fillRect(32*e,32*a,32,32),Math.random()>.8&&(t.fillStyle="#22c55e",t.fillRect(32*e+2,32*a+2,4,4)));K.forEach((e,a)=>{let l=32*e.x,s=32*e.y;if(t.fillStyle="#78716c",t.fillRect(l+1,s+1,30,30),t.strokeStyle="#57534e",t.lineWidth=2,t.strokeRect(l+1,s+1,30,30),a%3==0&&a<K.length-1){let i=K[a+1],o=i.x-e.x,r=i.y-e.y;t.fillStyle="#a8a29e",t.font="12px Arial",t.textAlign="center",o>0?t.fillText("→",l+16,s+16+4):o<0?t.fillText("←",l+16,s+16+4):r>0?t.fillText("↓",l+16,s+16+4):r<0&&t.fillText("↑",l+16,s+16+4)}}),c(!0)},[n]),w=(0,s.useCallback)(()=>{let e=a.current,t=r.current;if(!e||!t)return;let l=e.getContext("2d");if(l){if(l.clearRect(0,0,800,800),l.drawImage(t,0,0),d.towers.forEach(e=>{var t;let a=V[e.type],s=32*e.position.x,i=32*e.position.y;l.fillStyle="#44403c",l.fillRect(s+2,i+2,28,28);let o=l.createRadialGradient(s+16,i+16,0,s+16,i+16,16);if(o.addColorStop(0,a.color),o.addColorStop(1,a.color+"80"),l.fillStyle=o,l.fillRect(s+4,i+4,24,24),l.strokeStyle="#000000",l.lineWidth=2,l.strokeRect(s+4,i+4,24,24),l.fillStyle="white",l.font="16px Arial",l.textAlign="center",l.fillText(a.icon,s+16,i+16+5),l.fillStyle="#fbbf24",l.font="bold 10px Arial",l.fillText("Lv.".concat(e.level),s+16,i+32-4),e.specialSkills.length>0&&(l.fillStyle="#ef4444",l.beginPath(),l.arc(s+32-6,i+6,4,0,2*Math.PI),l.fill(),l.fillStyle="white",l.font="8px Arial",l.fillText("★",s+32-6,i+9)),void 0!==e.health&&void 0!==e.maxHealth){let t=s+2,a=i-6;l.fillStyle="#000000",l.fillRect(t,a,28,3);let o=e.health/e.maxHealth;l.fillStyle=o>.5?"#22c55e":o>.25?"#eab308":"#ef4444",l.fillRect(t,a,28*o,3)}(null===(t=d.selectedTower)||void 0===t?void 0:t.id)===e.id&&(l.strokeStyle="#fbbf24",l.lineWidth=3,l.setLineDash([5,5]),l.strokeRect(s+1,i+1,30,30),l.setLineDash([]),a.range>0&&(l.strokeStyle=a.color+"60",l.lineWidth=2,l.setLineDash([8,4]),l.beginPath(),l.arc(s+16,i+16,32*a.range,0,2*Math.PI),l.stroke(),l.setLineDash([])))}),d.heroes.forEach(e=>{var t;let a=Z[e.type],s=32*e.position.x+16,i=32*e.position.y+16;if(l.fillStyle="rgba(0, 0, 0, 0.3)",l.beginPath(),l.ellipse(s+2,i+18,12,6,0,0,2*Math.PI),l.fill(),"epic"===a.rarity){let t=.005*Date.now();l.strokeStyle="hsl(".concat((t+60*e.id.length)%360,", 70%, 60%)"),l.lineWidth=3,l.beginPath(),l.arc(s,i,20+3*Math.sin(t),0,2*Math.PI),l.stroke()}l.fillStyle=a.color,l.beginPath(),l.arc(s,i,"epic"===a.rarity?18:16,0,2*Math.PI),l.fill(),l.strokeStyle="epic"===a.rarity?"#ffd700":"#fbbf24",l.lineWidth="epic"===a.rarity?4:3,l.stroke(),l.fillStyle="white",l.font="epic"===a.rarity?"20px Arial":"18px Arial",l.textAlign="center",l.fillText(a.icon,s,i+6),l.fillStyle="epic"===a.rarity?"#ffd700":"#fbbf24",l.font="bold 10px Arial",l.fillText("Lv.".concat(e.level),s,i-22),"epic"===a.rarity&&(l.fillStyle="#ffd700",l.font="12px Arial",l.fillText("★",s+15,i-15));let o="epic"===a.rarity?36:32,r=s-o/2,n=i-("epic"===a.rarity?30:28);l.fillStyle="#000000",l.fillRect(r,n,o,4);let c=e.health/e.maxHealth;l.fillStyle=c>.6?"#22c55e":c>.3?"#eab308":"#ef4444",l.fillRect(r,n,o*c,4),(null===(t=d.selectedHero)||void 0===t?void 0:t.id)===e.id&&(l.strokeStyle="#fbbf24",l.lineWidth=3,l.setLineDash([5,5]),l.beginPath(),l.arc(s,i,22,0,2*Math.PI),l.stroke(),l.setLineDash([]))}),d.enemies.forEach(e=>{let t=X[e.type],a=32*e.position.x+16,s=32*e.position.y+16;l.fillStyle="rgba(0, 0, 0, 0.3)",l.beginPath(),l.ellipse(a+2,s+18,12,6,0,0,2*Math.PI),l.fill();let i=t.boss?20:e.elite?16:t.flying?16:14;if(l.fillStyle=e.controlled?"#22c55e":t.color,l.beginPath(),l.arc(a,s,i,0,2*Math.PI),l.fill(),e.elite||t.boss?(l.strokeStyle=e.elite?"#fbbf24":"#dc2626",l.lineWidth=3):(l.strokeStyle=e.controlled?"#22c55e":"#000000",l.lineWidth=2),l.stroke(),t.image){let i=new Image;i.crossOrigin="anonymous",i.src=t.image;let o=t.boss?32:e.elite?24:20;try{l.drawImage(i,a-o/2,s-o/2,o,o)}catch(e){l.fillStyle="white",l.font="".concat(t.boss?"20px":"16px"," Arial"),l.textAlign="center",l.fillText(t.emoji,a,s+6)}}else l.fillStyle="white",l.font="".concat(t.boss?"20px":"16px"," Arial"),l.textAlign="center",l.fillText(t.emoji,a,s+6);let o=a-14,r=s-i-8;l.fillStyle="#000000",l.fillRect(o,r,28,4);let n=e.health/e.maxHealth;l.fillStyle=n>.6?"#22c55e":n>.3?"#eab308":"#ef4444",l.fillRect(o,r,28*n,4),e.armor>0&&(l.fillStyle="#94a3b8",l.font="8px Arial",l.fillText("\uD83D\uDEE1".concat(e.armor),a,s-i-12)),e.slowEffect<1&&(l.strokeStyle="#06b6d4",l.lineWidth=3,l.setLineDash([2,2]),l.beginPath(),l.arc(a,s,i+3,0,2*Math.PI),l.stroke(),l.setLineDash([])),e.poisonDuration>0&&(l.fillStyle="#84cc16",l.font="12px Arial",l.fillText("☠️",a+i-5,s-i+5)),e.frozen&&(l.strokeStyle="#06b6d4",l.lineWidth=4,l.setLineDash([3,3]),l.beginPath(),l.arc(a,s,i+5,0,2*Math.PI),l.stroke(),l.setLineDash([])),e.controlled&&(l.strokeStyle="#22c55e",l.lineWidth=3,l.setLineDash([4,4]),l.beginPath(),l.arc(a,s,i+7,0,2*Math.PI),l.stroke(),l.setLineDash([])),t.flying&&(l.strokeStyle="#e5e7eb",l.lineWidth=1,l.setLineDash([3,3]),l.beginPath(),l.arc(a,s,i+5,0,2*Math.PI),l.stroke(),l.setLineDash([]))}),d.projectiles.forEach(e=>{let t=32*e.start.x+16,a=32*e.start.y+16,s=32*e.target.x+16,i=32*e.target.y+16,o=t+(s-t)*e.progress,r=a+(i-a)*e.progress;switch(l.save(),e.type){case"arrow":l.strokeStyle="#8b5a2b",l.lineWidth=3,l.beginPath(),l.moveTo(o-8,r),l.lineTo(o+8,r),l.stroke(),l.fillStyle="#ef4444",l.beginPath(),l.moveTo(o+8,r),l.lineTo(o+4,r-3),l.lineTo(o+4,r+3),l.fill();break;case"cannonball":l.fillStyle="#1f2937",l.beginPath(),l.arc(o,r,6,0,2*Math.PI),l.fill(),l.strokeStyle="#ef4444",l.lineWidth=2,l.stroke();break;case"magic":let n=.01*Date.now();l.fillStyle="hsl(".concat((n+360*e.progress)%360,", 70%, 60%)"),l.beginPath(),l.arc(o,r,5,0,2*Math.PI),l.fill(),l.strokeStyle=l.fillStyle,l.lineWidth=2,l.beginPath(),l.arc(o,r,8,0,2*Math.PI),l.stroke();break;case"ice":l.fillStyle="#06b6d4",l.beginPath(),l.arc(o,r,4,0,2*Math.PI),l.fill(),l.strokeStyle="#67e8f9",l.lineWidth=1;for(let e=0;e<6;e++){let t=e*Math.PI/3;l.beginPath(),l.moveTo(o,r),l.lineTo(o+8*Math.cos(t),r+8*Math.sin(t)),l.stroke()}break;case"lightning":case"tesla":l.strokeStyle="#eab308",l.lineWidth=4,l.shadowColor="#eab308",l.shadowBlur=10,l.beginPath(),l.moveTo(t,a);for(let e=1;e<=5;e++){let o=e/5,r=t+(s-t)*o,n=a+(i-a)*o+10*Math.sin(o*Math.PI*4);l.lineTo(r,n)}l.stroke(),l.shadowBlur=0;break;case"poison":l.fillStyle="#84cc16",l.beginPath(),l.arc(o,r,5,0,2*Math.PI),l.fill(),l.fillStyle="#84cc1660";for(let e=1;e<=3;e++){let n=o-(s-t)*.1*e,c=r-(i-a)*.1*e;l.beginPath(),l.arc(n,c,3-e,0,2*Math.PI),l.fill()}break;case"laser":l.strokeStyle="#ef4444",l.lineWidth=6,l.shadowColor="#ef4444",l.shadowBlur=15,l.beginPath(),l.moveTo(t,a),l.lineTo(s,i),l.stroke(),l.shadowBlur=0;break;case"missile":l.fillStyle="#f97316",l.beginPath(),l.arc(o,r,8,0,2*Math.PI),l.fill(),l.fillStyle="#fbbf24",l.beginPath(),l.arc(o,r,4,0,2*Math.PI),l.fill(),l.fillStyle="#ef444460";for(let e=1;e<=4;e++){let n=o-(s-t)*.05*e,c=r-(i-a)*.05*e;l.beginPath(),l.arc(n,c,6-e,0,2*Math.PI),l.fill()}break;case"plasma":l.strokeStyle="#ec4899",l.lineWidth=8,l.shadowColor="#ec4899",l.shadowBlur=20,l.beginPath(),l.moveTo(t,a),l.lineTo(s,i),l.stroke(),l.shadowBlur=0;break;case"nuclear":l.fillStyle="#dc2626",l.beginPath(),l.arc(o,r,12,0,2*Math.PI),l.fill(),l.fillStyle="#fbbf24",l.beginPath(),l.arc(o,r,8,0,2*Math.PI),l.fill(),l.strokeStyle="#dc262660",l.lineWidth=2;for(let e=1;e<=3;e++)l.beginPath(),l.arc(o,r,12+5*e,0,2*Math.PI),l.stroke();break;case"hero_attack":l.fillStyle=e.color,l.beginPath(),l.arc(o,r,6,0,2*Math.PI),l.fill(),l.strokeStyle="#ffd700",l.lineWidth=2,l.stroke()}l.restore()}),d.effects.forEach(e=>{let t=32*e.position.x+16,a=32*e.position.y+16,s=1-e.duration/e.maxDuration;switch(l.save(),e.type){case"explosion":let i=e.size*(1+2*s);l.fillStyle="rgba(239, 68, 68, ".concat(1-s,")"),l.beginPath(),l.arc(t,a,i,0,2*Math.PI),l.fill(),l.fillStyle="rgba(251, 191, 36, ".concat(1-s,")"),l.beginPath(),l.arc(t,a,.6*i,0,2*Math.PI),l.fill();break;case"freeze":l.strokeStyle="rgba(6, 182, 212, ".concat(1-s,")"),l.lineWidth=3,l.beginPath(),l.arc(t,a,e.size,0,2*Math.PI),l.stroke();break;case"poison_cloud":l.fillStyle="rgba(132, 204, 22, ".concat(.5*(1-s),")"),l.beginPath(),l.arc(t,a,e.size*(1+s),0,2*Math.PI),l.fill();break;case"skill_target":l.strokeStyle="rgba(251, 191, 36, ".concat(1-s,")"),l.lineWidth=4,l.setLineDash([10,5]),l.beginPath(),l.arc(t,a,e.size,0,2*Math.PI),l.stroke(),l.setLineDash([])}l.restore()}),d.droppedItems.forEach(e=>{let t=32*e.position.x+16,a=32*e.position.y+16;l.shadowColor="gold"===e.type?"#fbbf24":"skill"===e.type?"#8b5cf6":"#ef4444",l.shadowBlur=10,l.fillStyle="gold"===e.type?"#fbbf24":"skill"===e.type?"#8b5cf6":"#ef4444",l.beginPath(),l.arc(t,a,8,0,2*Math.PI),l.fill(),l.shadowBlur=0,l.fillStyle="white",l.font="12px Arial",l.textAlign="center";let s="gold"===e.type?"\uD83D\uDCB0":"skill"===e.type?"✨":"\uD83D\uDC51";l.fillText(s,t,a+4)}),d.selectedTowerType){l.fillStyle="rgba(34, 197, 94, 0.2)";for(let e=0;e<25;e++)for(let t=0;t<25;t++){let a=K.some(a=>a.x===e&&a.y===t),s=d.towers.some(a=>a.position.x===e&&a.position.y===t),i=d.heroes.some(a=>Math.floor(a.position.x)===e&&Math.floor(a.position.y)===t);a||s||i||l.fillRect(32*e+2,32*t+2,28,28)}}if(d.selectedTowerType||d.selectedSkill){l.strokeStyle="rgba(255, 255, 255, 0.1)",l.lineWidth=1;for(let e=0;e<=25;e++)l.beginPath(),l.moveTo(32*e,0),l.lineTo(32*e,800),l.stroke(),l.beginPath(),l.moveTo(0,32*e),l.lineTo(800,32*e),l.stroke()}}},[d]);(0,s.useEffect)(()=>{b()},[b]),(0,s.useEffect)(()=>{n&&w()},[w,n]);let v=(0,s.useCallback)(e=>{if("playing"!==d.status)return;let t=e-o.current;o.current=e,x(a=>{let l={...a};if(l.skills=l.skills.map(e=>({...e,cooldownRemaining:Math.max(0,e.cooldownRemaining-t)})),!l.waveInProgress&&l.wave<J.length&&l.autoWaveTimer>0&&(l.autoWaveTimer-=t,l.autoWaveTimer<=0))return k(),l;if(l.droppedItems=l.droppedItems.map(e=>({...e,duration:e.duration-t})).filter(e=>e.duration>0),l.enemies=l.enemies.map(e=>{let a={...e};if(a.controlled&&a.controlledDuration&&(a.controlledDuration-=t,a.controlledDuration<=0&&(a.controlled=!1,a.controlledDuration=0)),a.frozen&&a.frozenDuration&&(a.frozenDuration-=t,a.frozenDuration<=0&&(a.frozen=!1,a.frozenDuration=0)),a.frozen)return a;a.slowDuration>0&&(a.slowDuration-=t,a.slowDuration<=0&&(a.slowEffect=1)),a.poisonDuration>0&&((a.poisonDuration-=t,a.poisonDuration<=0)?a.poisonDamage=0:Math.floor(a.poisonDuration/1e3)!==Math.floor((a.poisonDuration+t)/1e3)&&(a.health-=a.poisonDamage));let s=a.controlled?-1:1,i=a.speed*a.slowEffect*(t/1e3)*s;if(a.pathIndex+=i,a.controlled&&a.pathIndex<=0)return null;if(a.pathIndex>=K.length-1)return l.lives-=1,null;let o=Math.max(0,Math.min(a.pathIndex,K.length-1)),r=Math.floor(o),n=Math.min(r+1,K.length-1),c=o-r,d=K[r],p=K[n];return a.position={x:d.x+(p.x-d.x)*c,y:d.y+(p.y-d.y)*c},a}).filter(Boolean),l.projectiles=l.projectiles.map(e=>{let a={...e};if(a.progress+=t/1e3*e.speed,a.progress>=1){let t=Object.values(V).find(t=>t.projectileType===e.type);if(null==t?void 0:t.splashRadius)l.enemies.filter(a=>Math.sqrt(Math.pow(a.position.x-e.target.x,2)+Math.pow(a.position.y-e.target.y,2))<=t.splashRadius).forEach(t=>{let a=Math.max(1,e.damage-t.armor);t.health-=a}),l.effects.push({id:"explosion-".concat(Date.now()),type:"explosion",position:e.target,duration:500,maxDuration:500,size:32*t.splashRadius,color:"#ef4444"});else if(null==t?void 0:t.chainCount){let a=l.enemies.find(t=>.5>Math.abs(t.position.x-e.target.x)&&.5>Math.abs(t.position.y-e.target.y)),s=new Set,i=e.damage;for(let e=0;e<t.chainCount&&a;e++)if(!s.has(a.id)){let e=Math.max(1,i-a.armor);a.health-=e,s.add(a.id);let t=l.enemies.filter(e=>!s.has(e.id)&&3>=Math.sqrt(Math.pow(e.position.x-a.position.x,2)+Math.pow(e.position.y-a.position.y,2)));a=t.length>0?t[0]:null,i*=.8}}else if(null==t?void 0:t.piercing)l.enemies.filter(t=>Math.abs((e.target.y-e.start.y)*t.position.x-(e.target.x-e.start.x)*t.position.y+e.target.x*e.start.y-e.target.y*e.start.x)/Math.sqrt(Math.pow(e.target.y-e.start.y,2)+Math.pow(e.target.x-e.start.x,2))<.5).forEach(t=>{let a=Math.max(1,e.damage-t.armor);t.health-=a});else{let a=l.enemies.find(t=>.5>Math.abs(t.position.x-e.target.x)&&.5>Math.abs(t.position.y-e.target.y));if(a){let l=Math.max(1,e.damage-a.armor);a.health-=l,(null==t?void 0:t.slowEffect)&&(a.slowEffect=t.slowEffect,a.slowDuration=t.slowDuration||2e3),(null==t?void 0:t.poisonDamage)&&(a.poisonDamage=t.poisonDamage,a.poisonDuration=t.poisonDuration||5e3)}}return null}return a}).filter(Boolean),l.effects=l.effects.map(e=>(e.duration-=t,e.duration>0?e:null)).filter(Boolean),l.towers.forEach(t=>{let a=V[t.type];if(0===a.damage||e-t.lastAttack<a.attackSpeed)return;let s=l.enemies.filter(e=>Math.sqrt(Math.pow(e.position.x-t.position.x,2)+Math.pow(e.position.y-t.position.y,2))<=a.range);if(a.oneTime){s.length>0&&(s[0],s.forEach(e=>{let l=Math.max(1,a.damage*t.level-e.armor);e.health-=l}),l.effects.push({id:"mine-explosion-".concat(Date.now()),type:"explosion",position:t.position,duration:800,maxDuration:800,size:32*a.range,color:"#ef4444"}),l.towers=l.towers.filter(e=>e.id!==t.id));return}if(s.length>0){let i=s.reduce((e,t)=>t.pathIndex>e.pathIndex?t:e),o={id:"projectile-".concat(Date.now(),"-").concat(Math.random()),type:a.projectileType,start:{...t.position},target:{...i.position},damage:a.damage*t.level,speed:6,progress:0,color:a.color,size:4};if(l.projectiles.push(o),t.lastAttack=e,t.specialSkills.includes("DOUBLE_SHOT")&&s.length>1){let e=s.find(e=>e.id!==i.id);if(e){let s={id:"projectile-".concat(Date.now(),"-").concat(Math.random(),"-2"),type:a.projectileType,start:{...t.position},target:{...e.position},damage:a.damage*t.level*.7,speed:6,progress:0,color:a.color,size:4};l.projectiles.push(s)}}}}),l.heroes.forEach(t=>{let a=Z[t.type];if(e-t.lastAttack<a.attackSpeed)return;let s=l.enemies.filter(e=>Math.sqrt(Math.pow(e.position.x-t.position.x,2)+Math.pow(e.position.y-t.position.y,2))<=a.range);if(s.length>0){let i=s.reduce((e,t)=>t.pathIndex>e.pathIndex?t:e),o={id:"hero-projectile-".concat(Date.now(),"-").concat(Math.random()),type:"hero_attack",start:{...t.position},target:{...i.position},damage:a.damage*t.level,speed:8,progress:0,color:a.color,size:6};l.projectiles.push(o),t.lastAttack=e,t.experience+="epic"===a.rarity?10:5,t.experience>=100*t.level&&(t.level+=1,t.experience=0,t.maxHealth+="epic"===a.rarity?100:50,t.health=t.maxHealth)}}),l.enemies=l.enemies.filter(e=>{if(e.health<=0){let t=X[e.type];l.gold+=t.reward,l.score+=10*t.reward;let a=.05;if(e.elite&&(a=.3),t.boss&&(a=.8),Math.random()<a){let a;let s=Math.random();if(s<.4)a={id:"drop-".concat(Date.now()),type:"gold",position:e.position,value:2*t.reward,duration:1e4};else if(s<.7){let t=Object.keys(Y),l=t[Math.floor(Math.random()*t.length)];a={id:"drop-".concat(Date.now()),type:"skill",position:e.position,value:l,duration:15e3}}else{let t=Object.keys(Z).filter(e=>"common"===Z[e].rarity),l=t[Math.floor(Math.random()*t.length)];a={id:"drop-".concat(Date.now()),type:"hero",position:e.position,value:l,duration:2e4}}l.droppedItems.push(a)}return!1}return!0}),l.lives<=0&&(l.status="gameOver"),l.waveInProgress&&0===l.enemies.length&&l.enemiesSpawned>=l.totalEnemiesInWave&&!l.bossSpawned){l.bossSpawned=!0;let e=["BOSS_GIANT","BOSS_LICH","BOSS_DRAGON"],t=e[Math.floor(Math.random()*e.length)],a=X[t],s=J[l.wave-1],i=(null==s?void 0:s.baseMultiplier)||1,o={id:"boss-".concat(Date.now()),type:t,position:{...K[0]},pathIndex:0,health:Math.floor(a.health*i),maxHealth:Math.floor(a.health*i),speed:a.speed,slowEffect:1,slowDuration:0,poisonDamage:0,poisonDuration:0,armor:Math.floor((a.armor||0)*Math.sqrt(i))};l.enemies.push(o)}if(l.bossSpawned&&0===l.enemies.length){var s;l.waveInProgress=!1,l.bossSpawned=!1;let e=(null===(s=J[l.wave-1])||void 0===s?void 0:s.reward)||50;l.gold+=e,l.wave>=J.length?l.status="victory":l.autoWaveTimer=15e3}return l}),i.current=requestAnimationFrame(v)},[d.status]);(0,s.useEffect)(()=>("playing"===d.status?(o.current=performance.now(),i.current=requestAnimationFrame(v)):i.current&&cancelAnimationFrame(i.current),()=>{i.current&&cancelAnimationFrame(i.current)}),[d.status,v]);let k=(0,s.useCallback)(()=>{if(d.waveInProgress||d.wave>=J.length)return;let e=J[d.wave],t=e.enemies.reduce((e,t)=>e+t.count,0),a=Math.floor(t*e.eliteChance);t+=a,x(e=>({...e,waveInProgress:!0,enemiesSpawned:0,totalEnemiesInWave:t,wave:e.wave+1,autoWaveTimer:0,bossSpawned:!1}));let l=0;e.enemies.forEach(t=>{for(let a=0;a<t.count;a++)setTimeout(()=>{let a=X[t.type],l=e.baseMultiplier||1,s={id:"enemy-".concat(Date.now(),"-").concat(Math.random()),type:t.type,position:{...K[0]},pathIndex:0,health:Math.floor(a.health*l),maxHealth:Math.floor(a.health*l),speed:a.speed,slowEffect:1,slowDuration:0,poisonDamage:0,poisonDuration:0,armor:Math.floor((a.armor||0)*Math.sqrt(l))};x(e=>({...e,enemies:[...e.enemies,s],enemiesSpawned:e.enemiesSpawned+1}))},l),l+=e.delay});for(let t=0;t<a;t++)setTimeout(()=>{let t=["ELITE_ORC","ELITE_TROLL"],a=t[Math.floor(Math.random()*t.length)],l=X[a],s=e.baseMultiplier||1,i={id:"elite-".concat(Date.now(),"-").concat(Math.random()),type:a,position:{...K[0]},pathIndex:0,health:Math.floor(l.health*s),maxHealth:Math.floor(l.health*s),speed:l.speed,slowEffect:1,slowDuration:0,poisonDamage:0,poisonDuration:0,armor:Math.floor((l.armor||0)*Math.sqrt(s)),elite:!0};x(e=>({...e,enemies:[...e.enemies,i],enemiesSpawned:e.enemiesSpawned+1}))},l+2e3*t)},[d.waveInProgress,d.wave]),N=(0,s.useCallback)(e=>{let t=a.current;if(!t)return;let l=t.getBoundingClientRect(),s=Math.floor((e.clientX-l.left)/32),i=Math.floor((e.clientY-l.top)/32);if(s<0||s>=25||i<0||i>=25)return;let o=d.droppedItems.find(e=>Math.floor(e.position.x)===s&&Math.floor(e.position.y)===i);if(o){x(e=>{let t={...e};return"gold"===o.type?t.gold+=o.value:"skill"===o.type?t.skills.find(e=>e.type===o.value)||t.skills.push({id:"skill-".concat(Date.now()),type:o.value,cooldownRemaining:0}):"hero"===o.type&&(t.selectedHero={id:"hero-".concat(Date.now()),type:o.value,position:{x:0,y:0},level:1,experience:0,health:Z[o.value].health,maxHealth:Z[o.value].health,lastAttack:0,skills:[]},t.showHeroDialog=!0),t.droppedItems=t.droppedItems.filter(e=>e.id!==o.id),t});return}let r=d.towers.find(e=>e.position.x===s&&e.position.y===i);if(r){x(e=>({...e,selectedTower:r,selectedTowerType:null,selectedHero:null,showUpgradeDialog:!0}));return}if(d.selectedHero&&!d.heroes.find(e=>{var t;return e.id===(null===(t=d.selectedHero)||void 0===t?void 0:t.id)})){let e=K.some(e=>e.x===s&&e.y===i),t=d.towers.some(e=>e.position.x===s&&e.position.y===i),a=d.heroes.some(e=>Math.floor(e.position.x)===s&&Math.floor(e.position.y)===i);if(!e&&!t&&!a){let e={...d.selectedHero,position:{x:s,y:i}};x(t=>({...t,heroes:[...t.heroes,e],selectedHero:null,showHeroDialog:!1}))}return}if(!d.selectedTowerType)return;let n=V[d.selectedTowerType];if(d.gold<n.cost)return;let c=K.some(e=>e.x===s&&e.y===i),p=d.towers.some(e=>e.position.x===s&&e.position.y===i),h=d.heroes.some(e=>Math.floor(e.position.x)===s&&Math.floor(e.position.y)===i);if(c||p||h)return;let m={id:"tower-".concat(Date.now()),type:d.selectedTowerType,position:{x:s,y:i},level:1,lastAttack:0,specialSkills:[]};n.blocking&&(m.health=n.health,m.maxHealth=n.health),x(e=>({...e,towers:[...e.towers,m],gold:e.gold-n.cost,selectedTowerType:null}))},[d.selectedTowerType,d.gold,d.towers,d.droppedItems,d.selectedSkill,d.skills,d.selectedHero,d.heroes]),T=(0,s.useCallback)(e=>{x(t=>{let a=t.towers.find(t=>t.id===e);if(!a||a.level>=10)return t;let l=Math.floor(60*Math.pow(1.5,a.level-1));if(t.gold<l)return t;let s=t.towers.map(t=>{if(t.id===e){let e={...t,level:t.level+1};if(.3>Math.random()&&e.specialSkills.length<3){let t=Object.keys(q).filter(t=>!e.specialSkills.includes(t));if(t.length>0){let a=t[Math.floor(Math.random()*t.length)];e.specialSkills.push(a)}}return e}return t});return{...t,towers:s,gold:t.gold-l}})},[]),Q=(0,s.useCallback)(e=>{x(t=>{let a=t.towers.find(t=>t.id===e);if(!a)return t;let l=Math.floor(.75*V[a.type].cost);for(let e=1;e<a.level;e++)l+=Math.floor(60*Math.pow(1.5,e-1)*.75);return{...t,towers:t.towers.filter(t=>t.id!==e),gold:t.gold+l,selectedTower:null,showUpgradeDialog:!1}})},[]),$=(0,s.useCallback)(()=>{if("我是小顾的朋友"===d.codeInput.trim()){let e=Object.keys(Z).filter(e=>"epic"===Z[e].rarity),t=e[Math.floor(Math.random()*e.length)],a={id:"epic-hero-".concat(Date.now()),type:t,position:{x:1,y:1},level:5,experience:0,health:Z[t].health,maxHealth:Z[t].health,lastAttack:0,skills:Z[t].skills};x(e=>({...e,heroes:[...e.heroes,a],gold:e.gold+1e3,codeInput:"",showCodeDialog:!1})),alert("恭喜！获得史诗英雄：".concat(Z[t].name,"！"))}else alert("口令错误，请重新输入！")},[d.codeInput]),ee=()=>x(e=>({...e,status:"playing"}));return(0,l.jsxs)("div",{className:"flex flex-col xl:flex-row gap-6 p-4 bg-gradient-to-b from-slate-900 via-slate-800 to-slate-900 min-h-screen",children:[(0,l.jsx)("canvas",{ref:r,width:800,height:800,style:{display:"none"}}),(0,l.jsx)("div",{className:"flex-1",children:(0,l.jsxs)(h,{className:"bg-slate-800/90 border-slate-700 backdrop-blur-sm",children:[(0,l.jsx)(m,{className:"pb-3",children:(0,l.jsxs)("div",{className:"flex justify-between items-center",children:[(0,l.jsx)(g,{className:"text-white text-xl flex items-center gap-2",children:"\uD83C\uDFF0 魔兽塔防 - 终极挑战"}),(0,l.jsxs)("div",{className:"flex gap-2",children:["idle"===d.status&&(0,l.jsxs)(p,{onClick:ee,className:"bg-green-600 hover:bg-green-700",children:[(0,l.jsx)(P.A,{className:"w-4 h-4 mr-2"}),"开始游戏"]}),"playing"===d.status&&(0,l.jsxs)(p,{onClick:()=>x(e=>({...e,status:"paused"})),variant:"outline",className:"border-slate-600 text-slate-300 bg-transparent hover:bg-slate-700",children:[(0,l.jsx)(A.A,{className:"w-4 h-4 mr-2"}),"暂停"]}),"paused"===d.status&&(0,l.jsxs)(p,{onClick:ee,className:"bg-green-600 hover:bg-green-700",children:[(0,l.jsx)(P.A,{className:"w-4 h-4 mr-2"}),"继续"]}),(0,l.jsxs)(p,{onClick:()=>x(e=>({...e,showCodeDialog:!0})),className:"bg-purple-600 hover:bg-purple-700",children:[(0,l.jsx)(W.A,{className:"w-4 h-4 mr-2"}),"口令兑换"]}),(0,l.jsxs)(p,{onClick:()=>{x({status:"idle",lives:50,gold:500,wave:0,score:0,towers:[],enemies:[],heroes:[],projectiles:[],effects:[],droppedItems:[],skills:[],selectedTowerType:null,selectedTower:null,selectedHero:null,selectedSkill:null,waveInProgress:!1,enemiesSpawned:0,totalEnemiesInWave:0,showUpgradeDialog:!1,showHeroDialog:!1,showCodeDialog:!1,autoWaveTimer:0,bossSpawned:!1,codeInput:""}),c(!1)},variant:"outline",className:"border-slate-600 text-slate-300 bg-transparent hover:bg-slate-700",children:[(0,l.jsx)(O.A,{className:"w-4 h-4 mr-2"}),"重置"]})]})]})}),(0,l.jsxs)(f,{children:[(0,l.jsxs)("div",{className:"flex flex-wrap gap-3 mb-4",children:[(0,l.jsxs)(y,{variant:"outline",className:"border-red-500 text-red-400 bg-red-500/20 px-3 py-1",children:[(0,l.jsx)(L.A,{className:"w-4 h-4 mr-1"}),"生命: ",d.lives]}),(0,l.jsxs)(y,{variant:"outline",className:"border-yellow-500 text-yellow-400 bg-yellow-500/20 px-3 py-1",children:[(0,l.jsx)(H.A,{className:"w-4 h-4 mr-1"}),"金币: ",d.gold]}),(0,l.jsxs)(y,{variant:"outline",className:"border-blue-500 text-blue-400 bg-blue-500/20 px-3 py-1",children:[(0,l.jsx)(G.A,{className:"w-4 h-4 mr-1"}),"波次: ",d.wave,"/100"]}),(0,l.jsxs)(y,{variant:"outline",className:"border-purple-500 text-purple-400 bg-purple-500/20 px-3 py-1",children:[(0,l.jsx)(B.A,{className:"w-4 h-4 mr-1"}),"分数: ",d.score]}),d.autoWaveTimer>0&&(0,l.jsxs)(y,{variant:"outline",className:"border-green-500 text-green-400 bg-green-500/20 px-3 py-1",children:["⏱️ 下一波: ",Math.ceil(d.autoWaveTimer/1e3),"s"]})]}),d.skills.length>0&&(0,l.jsxs)("div",{className:"flex gap-2 mb-4 p-3 bg-slate-700/50 rounded-lg",children:[(0,l.jsx)("div",{className:"text-sm text-slate-300 mr-2",children:"技能:"}),d.skills.map(e=>{let t=Y[e.type],a=e.cooldownRemaining>0;return(0,l.jsxs)(p,{variant:"outline",size:"sm",disabled:a,className:"relative bg-slate-600 hover:bg-slate-500",children:[(0,l.jsx)("span",{className:"text-lg mr-1",children:t.icon}),t.name,a&&(0,l.jsxs)("div",{className:"absolute inset-0 bg-slate-800/70 rounded flex items-center justify-center text-xs",children:[Math.ceil(e.cooldownRemaining/1e3),"s"]})]},e.id)})]}),(0,l.jsx)("div",{className:"border-2 border-slate-600 rounded-lg overflow-hidden shadow-2xl",children:(0,l.jsx)("canvas",{ref:a,width:800,height:800,onClick:N,className:"cursor-pointer",style:{background:"#0f172a"}})}),(0,l.jsx)("div",{className:"mt-3 text-sm text-slate-400",children:d.selectedHero?(0,l.jsxs)("p",{children:["\uD83D\uDC51 点击空白区域放置英雄 ",Z[d.selectedHero.type].name]}):d.selectedTowerType?(0,l.jsxs)("p",{children:["\uD83D\uDCA1 点击空白区域放置 ",V[d.selectedTowerType].name]}):(0,l.jsx)("p",{children:"\uD83D\uDCA1 选择建筑类型，点击掉落物品拾取，点击建筑进行升级管理"})}),"gameOver"===d.status&&(0,l.jsxs)("div",{className:"mt-4 p-4 bg-red-900/50 border border-red-700 rounded-lg text-center backdrop-blur-sm",children:[(0,l.jsx)("h3",{className:"text-lg font-bold text-red-400",children:"\uD83D\uDC80 守卫失败!"}),(0,l.jsxs)("p",{className:"text-red-300",children:["在第 ",d.wave," 波被击败"]}),(0,l.jsxs)("p",{className:"text-red-300",children:["最终分数: ",d.score]})]}),"victory"===d.status&&(0,l.jsxs)("div",{className:"mt-4 p-4 bg-green-900/50 border border-green-700 rounded-lg text-center backdrop-blur-sm",children:[(0,l.jsx)("h3",{className:"text-lg font-bold text-green-400",children:"\uD83C\uDF89 传奇守卫者! \uD83C\uDF89"}),(0,l.jsx)("p",{className:"text-green-300",children:"你完成了全部100波的终极挑战!"}),(0,l.jsxs)("p",{className:"text-green-300",children:["最终分数: ",d.score]})]})]})]})}),(0,l.jsx)("div",{className:"w-full xl:w-96 space-y-4",children:(0,l.jsxs)(C,{defaultValue:"towers",className:"w-full",children:[(0,l.jsxs)(I,{className:"grid w-full grid-cols-3 bg-slate-800/90 border-slate-700",children:[(0,l.jsx)(E,{value:"towers",className:"data-[state=active]:bg-slate-700",children:"\uD83C\uDFD7️ 建筑"}),(0,l.jsx)(E,{value:"heroes",className:"data-[state=active]:bg-slate-700",children:"\uD83D\uDC51 英雄"}),(0,l.jsx)(E,{value:"stats",className:"data-[state=active]:bg-slate-700",children:"\uD83D\uDCCA 统计"})]}),(0,l.jsxs)(_,{value:"towers",className:"space-y-4",children:[(0,l.jsxs)(h,{className:"bg-slate-800/90 border-slate-700 backdrop-blur-sm",children:[(0,l.jsx)(m,{className:"pb-3",children:(0,l.jsx)(g,{className:"text-white text-lg",children:"\uD83C\uDFD7️ 防御建筑"})}),(0,l.jsx)(f,{className:"space-y-3 max-h-96 overflow-y-auto",children:Object.entries(V).map(e=>{let[t,a]=e,s=d.selectedTowerType===t,i=d.gold>=a.cost;return(0,l.jsx)(p,{variant:s?"default":"outline",className:"w-full justify-start p-4 h-auto transition-all ".concat(i?s?"bg-blue-600 hover:bg-blue-700 border-blue-500 shadow-lg":"bg-slate-700/50 hover:bg-slate-600/70 border-slate-600 text-slate-300":"opacity-50 cursor-not-allowed"),onClick:()=>i&&x(e=>({...e,selectedTowerType:s?null:t,selectedTower:null,selectedHero:null,selectedSkill:null})),disabled:!i,children:(0,l.jsxs)("div",{className:"flex items-center gap-3 w-full",children:[(0,l.jsx)("div",{className:"p-2 rounded-lg text-xl",style:{backgroundColor:a.color+"30",border:"2px solid ".concat(a.color)},children:a.icon}),(0,l.jsxs)("div",{className:"text-left flex-1",children:[(0,l.jsx)("div",{className:"font-medium text-white",children:a.name}),(0,l.jsxs)("div",{className:"text-xs text-slate-400 flex gap-2",children:[(0,l.jsxs)("span",{children:["\uD83D\uDCB0",a.cost]}),a.damage>0&&(0,l.jsxs)("span",{children:["⚔️",a.damage]}),a.range>0&&(0,l.jsxs)("span",{children:["\uD83D\uDCCF",a.range]})]}),(0,l.jsx)("div",{className:"text-xs text-slate-500 mt-1",children:a.description})]})]})},t)})})]}),(0,l.jsxs)(h,{className:"bg-slate-800/90 border-slate-700 backdrop-blur-sm",children:[(0,l.jsx)(m,{className:"pb-3",children:(0,l.jsx)(g,{className:"text-white text-lg",children:"⚔️ 战斗控制"})}),(0,l.jsx)(f,{children:(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center text-slate-300",children:[(0,l.jsx)("span",{children:"当前波次:"}),(0,l.jsxs)(y,{className:"bg-blue-600 text-white px-3 py-1",children:[d.wave,"/100"]})]}),d.waveInProgress&&(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsxs)("div",{className:"flex justify-between text-sm text-slate-400",children:[(0,l.jsx)("span",{children:"敌人进度:"}),(0,l.jsxs)("span",{children:[d.enemiesSpawned,"/",d.totalEnemiesInWave]})]}),(0,l.jsx)(u,{value:d.enemiesSpawned/d.totalEnemiesInWave*100,className:"bg-slate-700"}),d.bossSpawned&&(0,l.jsx)("div",{className:"text-center text-red-400 font-bold",children:"\uD83D\uDC7F Boss已出现!"})]}),(0,l.jsx)(p,{onClick:k,disabled:d.waveInProgress||d.wave>=100||"playing"!==d.status,className:"w-full bg-green-600 hover:bg-green-700 disabled:bg-slate-600 py-3",children:d.waveInProgress?"\uD83D\uDD25 战斗进行中...":"⚔️ 开始下一波"}),d.autoWaveTimer>0&&(0,l.jsxs)("div",{className:"text-xs text-slate-400 text-center bg-slate-700/50 p-2 rounded",children:["自动开始倒计时: ",Math.ceil(d.autoWaveTimer/1e3),"秒"]}),d.wave<100&&(0,l.jsxs)("div",{className:"text-xs text-slate-400 text-center bg-slate-700/50 p-2 rounded",children:["下一波奖励: +",(null===(e=J[d.wave])||void 0===e?void 0:e.reward)||0," \uD83D\uDCB0",(0,l.jsx)("br",{}),"难度倍数: x",((null===(t=J[d.wave])||void 0===t?void 0:t.baseMultiplier)||1).toFixed(1)]})]})})]})]}),(0,l.jsx)(_,{value:"heroes",className:"space-y-4",children:(0,l.jsxs)(h,{className:"bg-slate-800/90 border-slate-700 backdrop-blur-sm",children:[(0,l.jsx)(m,{className:"pb-3",children:(0,l.jsxs)(g,{className:"text-white text-lg flex items-center gap-2",children:[(0,l.jsx)(z.A,{className:"w-5 h-5"}),"英雄部队 (",d.heroes.length,")"]})}),(0,l.jsxs)(f,{children:[0===d.heroes.length?(0,l.jsxs)("div",{className:"text-center py-4",children:[(0,l.jsx)("p",{className:"text-slate-400 mb-2",children:"暂无英雄"}),(0,l.jsx)("p",{className:"text-xs text-slate-500",children:"击败敌人有机会获得英雄，或使用口令兑换史诗英雄"})]}):(0,l.jsx)("div",{className:"space-y-2",children:d.heroes.map(e=>{let t=Z[e.type];return(0,l.jsxs)("div",{className:"flex items-center gap-3 p-3 rounded-lg border cursor-pointer hover:bg-slate-600/50 ".concat("epic"===t.rarity?"bg-gradient-to-r from-purple-900/50 to-pink-900/50 border-purple-500":"bg-slate-700/50 border-slate-600"),children:[(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)("img",{src:t.image||"/placeholder.svg",alt:t.name,className:"w-12 h-12 rounded-lg border-2 ".concat("epic"===t.rarity?"border-purple-400":"border-slate-400"),style:{borderColor:t.color}}),"epic"===t.rarity&&(0,l.jsx)("div",{className:"absolute -top-1 -right-1 bg-purple-500 rounded-full w-4 h-4 flex items-center justify-center",children:(0,l.jsx)(U.A,{className:"w-2 h-2 text-white"})})]}),(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsxs)("div",{className:"font-medium ".concat("epic"===t.rarity?"text-purple-300":"text-white"),children:[t.name,"epic"===t.rarity&&(0,l.jsx)("span",{className:"text-xs ml-1",children:"⭐史诗"})]}),(0,l.jsxs)("div",{className:"text-xs text-slate-400",children:["等级 ",e.level," | 血量 ",e.health,"/",e.maxHealth]}),(0,l.jsxs)("div",{className:"text-xs text-slate-500",children:["经验 ",e.experience,"/",100*e.level]}),t.series&&(0,l.jsx)("div",{className:"text-xs text-slate-500",children:"dragon_ball"===t.series?"\uD83D\uDC09 龙珠系列":"\uD83C\uDFAE 宝可梦系列"})]}),(0,l.jsx)(p,{size:"sm",onClick:()=>x(t=>({...t,selectedHero:e,selectedTowerType:null})),className:"bg-green-600 hover:bg-green-700 text-xs px-2 py-1",children:"放置"})]},e.id)})}),(0,l.jsxs)("div",{className:"mt-4 text-xs text-slate-400 space-y-1",children:[(0,l.jsx)("div",{className:"font-medium",children:"英雄说明:"}),(0,l.jsx)("div",{children:"• 普通英雄：击败敌人有5%几率掉落"}),(0,l.jsx)("div",{children:"• 史诗英雄：通过口令兑换获得，属性更强"}),(0,l.jsx)("div",{children:"• 龙珠英雄：拥有超强战斗力和独特技能"}),(0,l.jsx)("div",{children:"• 宝可梦英雄：拥有元素属性和特殊能力"})]})]})]})}),(0,l.jsx)(_,{value:"stats",className:"space-y-4",children:(0,l.jsxs)(h,{className:"bg-slate-800/90 border-slate-700 backdrop-blur-sm",children:[(0,l.jsx)(m,{className:"pb-3",children:(0,l.jsx)(g,{className:"text-white text-lg",children:"\uD83D\uDCCA 战斗统计"})}),(0,l.jsxs)(f,{className:"space-y-3",children:[(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,l.jsxs)("div",{className:"bg-slate-700/50 p-3 rounded-lg text-center",children:[(0,l.jsx)("div",{className:"text-2xl font-bold text-blue-400",children:d.towers.length}),(0,l.jsx)("div",{className:"text-xs text-slate-400",children:"防御建筑"})]}),(0,l.jsxs)("div",{className:"bg-slate-700/50 p-3 rounded-lg text-center",children:[(0,l.jsx)("div",{className:"text-2xl font-bold text-green-400",children:d.heroes.length}),(0,l.jsx)("div",{className:"text-xs text-slate-400",children:"英雄数量"})]}),(0,l.jsxs)("div",{className:"bg-slate-700/50 p-3 rounded-lg text-center",children:[(0,l.jsx)("div",{className:"text-2xl font-bold text-red-400",children:d.enemies.length}),(0,l.jsx)("div",{className:"text-xs text-slate-400",children:"当前敌人"})]}),(0,l.jsxs)("div",{className:"bg-slate-700/50 p-3 rounded-lg text-center",children:[(0,l.jsx)("div",{className:"text-2xl font-bold text-purple-400",children:d.skills.length}),(0,l.jsx)("div",{className:"text-xs text-slate-400",children:"可用技能"})]})]}),(0,l.jsxs)("div",{className:"space-y-2 mt-4",children:[(0,l.jsx)("div",{className:"text-sm text-slate-300 font-medium",children:"史诗英雄介绍:"}),(0,l.jsxs)("div",{className:"space-y-1 text-xs text-slate-400 max-h-32 overflow-y-auto",children:[(0,l.jsx)("div",{children:"\uD83E\uDD4B 孙悟空 - 地球最强战士，龟派气功"}),(0,l.jsx)("div",{children:"\uD83D\uDC51 贝吉塔 - 赛亚人王子，终极闪光"}),(0,l.jsx)("div",{children:"\uD83D\uDCDA 孙悟饭 - 悟空之子，潜能解放"}),(0,l.jsx)("div",{children:"\uD83E\uDDD8 比克 - 那美克星人，魔贯光杀炮"}),(0,l.jsx)("div",{children:"⚡ 皮卡丘 - 电气鼠，十万伏特"}),(0,l.jsx)("div",{children:"\uD83D\uDD25 喷火龙 - 火系飞行，喷射火焰"}),(0,l.jsx)("div",{children:"\uD83E\uDDE0 超梦 - 传说宝可梦，精神强念"}),(0,l.jsx)("div",{children:"\uD83D\uDC4A 路卡利欧 - 波导宝可梦，波导弹"})]})]})]})]})})]})}),(0,l.jsx)(j,{open:d.showUpgradeDialog,onOpenChange:e=>x(t=>({...t,showUpgradeDialog:e,selectedTower:e?t.selectedTower:null})),children:(0,l.jsxs)(D,{className:"bg-slate-800/95 border-slate-700 text-white max-w-md backdrop-blur-sm",children:[(0,l.jsx)(S,{children:(0,l.jsx)(M,{className:"text-lg font-bold text-center",children:"\uD83C\uDFD7️ 建筑管理"})}),d.selectedTower&&(0,l.jsxs)("div",{className:"space-y-4 p-4",children:[(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"text-2xl mb-2",children:V[d.selectedTower.type].icon}),(0,l.jsx)("h3",{className:"text-lg font-bold",children:V[d.selectedTower.type].name}),(0,l.jsxs)("p",{className:"text-sm text-slate-400",children:["等级 ",d.selectedTower.level]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[(0,l.jsxs)("div",{className:"bg-slate-700/50 p-2 rounded",children:[(0,l.jsx)("div",{className:"text-slate-400",children:"攻击力"}),(0,l.jsx)("div",{className:"font-bold",children:V[d.selectedTower.type].damage*d.selectedTower.level})]}),(0,l.jsxs)("div",{className:"bg-slate-700/50 p-2 rounded",children:[(0,l.jsx)("div",{className:"text-slate-400",children:"射程"}),(0,l.jsx)("div",{className:"font-bold",children:V[d.selectedTower.type].range})]})]}),d.selectedTower.specialSkills.length>0&&(0,l.jsxs)("div",{className:"bg-slate-700/50 p-3 rounded",children:[(0,l.jsx)("div",{className:"text-sm font-medium mb-2",children:"特殊技能:"}),(0,l.jsx)("div",{className:"space-y-1",children:d.selectedTower.specialSkills.map(e=>{let t=q[e];return(0,l.jsxs)("div",{className:"flex items-center gap-2 text-xs",children:[(0,l.jsx)("span",{children:t.icon}),(0,l.jsx)("span",{className:"text-yellow-400",children:t.name}),(0,l.jsxs)("span",{className:"text-slate-400",children:["- ",t.description]})]},e)})})]}),(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsxs)(p,{onClick:()=>T(d.selectedTower.id),disabled:d.selectedTower.level>=10||d.gold<Math.floor(60*Math.pow(1.5,d.selectedTower.level-1)),className:"flex-1 bg-blue-600 hover:bg-blue-700",children:[(0,l.jsx)(F.A,{className:"w-4 h-4 mr-2"}),"升级 (\uD83D\uDCB0",Math.floor(60*Math.pow(1.5,d.selectedTower.level-1)),")"]}),(0,l.jsx)(p,{onClick:()=>Q(d.selectedTower.id),variant:"outline",className:"border-red-600 text-red-400 hover:bg-red-600/20",children:"出售"})]})]})]})}),(0,l.jsx)(j,{open:d.showCodeDialog,onOpenChange:e=>x(t=>({...t,showCodeDialog:e,codeInput:e?t.codeInput:""})),children:(0,l.jsxs)(D,{className:"bg-slate-800/95 border-slate-700 text-white max-w-md backdrop-blur-sm",children:[(0,l.jsx)(S,{children:(0,l.jsxs)(M,{className:"text-lg font-bold text-center flex items-center justify-center gap-2",children:[(0,l.jsx)(W.A,{className:"w-6 h-6 text-purple-400"}),"口令兑换"]})}),(0,l.jsxs)("div",{className:"space-y-4 p-4",children:[(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("p",{className:"text-slate-300 mb-2",children:"输入神秘口令获得史诗英雄！"}),(0,l.jsx)("p",{className:"text-xs text-slate-500",children:"提示：小顾的朋友都知道这个口令"})]}),(0,l.jsxs)("div",{className:"space-y-3",children:[(0,l.jsx)(R,{type:"text",value:d.codeInput,onChange:e=>x(t=>({...t,codeInput:e.target.value})),placeholder:"请输入口令...",className:"w-full p-3 bg-slate-700 border border-slate-600 rounded-lg text-white placeholder-slate-400 focus:outline-none focus:border-purple-500",onKeyPress:e=>"Enter"===e.key&&$()}),(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsxs)(p,{onClick:$,className:"flex-1 bg-purple-600 hover:bg-purple-700",disabled:!d.codeInput.trim(),children:[(0,l.jsx)(W.A,{className:"w-4 h-4 mr-2"}),"兑换"]}),(0,l.jsx)(p,{onClick:()=>x(e=>({...e,showCodeDialog:!1,codeInput:""})),variant:"outline",className:"border-slate-600 text-slate-300 hover:bg-slate-700",children:"取消"})]})]}),(0,l.jsxs)("div",{className:"bg-slate-700/50 p-3 rounded-lg",children:[(0,l.jsx)("div",{className:"text-sm text-slate-300 font-medium mb-2",children:"史诗英雄预览:"}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-xs text-slate-400",children:[(0,l.jsx)("div",{children:"\uD83E\uDD4B 孙悟空 - 龟派气功"}),(0,l.jsx)("div",{children:"\uD83D\uDC51 贝吉塔 - 终极闪光"}),(0,l.jsx)("div",{children:"⚡ 皮卡丘 - 十万伏特"}),(0,l.jsx)("div",{children:"\uD83D\uDD25 喷火龙 - 喷射火焰"}),(0,l.jsx)("div",{children:"\uD83E\uDDE0 超梦 - 精神强念"}),(0,l.jsx)("div",{children:"\uD83D\uDC4A 路卡利欧 - 波导弹"})]})]})]})]})})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[889,441,684,358],()=>t(2747)),_N_E=e.O()}]);